const getFileExtension = (language: string): string => {
  const extensionMap: { [key: string]: string } = {
    javascript: "js",
    js: "js",
    jsx: "jsx",
    mjs: "mjs",
    cjs: "cjs",
    typescript: "ts",
    ts: "ts",
    tsx: "tsx",
    mts: "mts",
    cts: "cts",
    coffeescript: "coffee",
    coffee: "coffee",
    python: "py",
    py: "py",
    pyw: "pyw",
    pyi: "pyi",
    ipynb: "ipynb",
    ruby: "rb",
    rb: "rb",
    erb: "erb",
    perl: "pl",
    pl: "pl",
    pm: "pm",
    php: "php",
    phtml: "php",
    php3: "php",
    php4: "php",
    php5: "php",
    php7: "php",
    lua: "lua",
    tcl: "tcl",
    tk: "tcl",
    groovy: "groovy",
    gvy: "groovy",
    gradle: "gradle",
    dart: "dart",
    actionscript: "as",
    as: "as",
    as3: "as",
    coldfusion: "cfm",
    cfm: "cfm",
    asp: "asp",
    aspx: "aspx",
    jsp: "jsp",
    jspx: "jspx",
    vbs: "vbs",
    vbscript: "vbs",
    autoit: "au3",
    au3: "au3",
    ahk: "ahk",
    autohotkey: "ahk",
    applescript: "scpt",
    scpt: "scpt",
    c: "c",
    h: "h",
    cpp: "cpp",
    "c++": "cpp",
    cxx: "cpp",
    cc: "cpp",
    hpp: "hpp",
    hxx: "hpp",
    hh: "hpp",
    csharp: "cs",
    cs: "cs",
    "c#": "cs",
    csx: "csx",
    go: "go",
    golang: "go",
    rust: "rs",
    rs: "rs",
    rlib: "rlib",
    swift: "swift",
    kotlin: "kt",
    kt: "kt",
    kts: "kts",
    java: "java",
    jar: "jar",
    class: "class",
    scala: "scala",
    sc: "scala",
    clojure: "clj",
    clj: "clj",
    cljs: "cljs",
    cljc: "cljc",
    edn: "edn",
    haskell: "hs",
    hs: "hs",
    lhs: "lhs",
    erlang: "erl",
    erl: "erl",
    hrl: "hrl",
    elixir: "ex",
    ex: "ex",
    exs: "exs",
    fsharp: "fs",
    fs: "fs",
    fsi: "fsi",
    fsx: "fsx",
    ocaml: "ml",
    ml: "ml",
    mli: "mli",
    reason: "re",
    re: "re",
    res: "res",
    d: "d",
    dlang: "d",
    di: "di",
    nim: "nim",
    nimrod: "nim",
    zig: "zig",
    v: "v",
    vlang: "v",
    crystal: "cr",
    cr: "cr",
    julia: "jl",
    jl: "jl",
    r: "r",
    rlang: "r",
    rmd: "rmd",
    matlab: "m",
    octave: "m",
    fortran: "f90",
    f: "f",
    f77: "f77",
    f90: "f90",
    f95: "f95",
    cobol: "cbl",
    cbl: "cbl",
    cpy: "cpy",
    pascal: "pas",
    pas: "pas",
    delphi: "dpr",
    dpr: "dpr",
    lisp: "lisp",
    lsp: "lsp",
    el: "el",
    scheme: "scm",
    scm: "scm",
    racket: "rkt",
    rkt: "rkt",
    smalltalk: "st",
    st: "st",
    ada: "adb",
    adb: "adb",
    ads: "ads",
    prolog: "pl",
    p: "p",
    abap: "abap",
    apex: "cls",
    bash: "sh",
    sh: "sh",
    shell: "sh",
    zsh: "zsh",
    zshrc: "zshrc",
    bashrc: "bashrc",
    fish: "fish",
    powershell: "ps1",
    ps1: "ps1",
    psm1: "psm1",
    psd1: "psd1",
    batch: "bat",
    bat: "bat",
    cmd: "cmd",
    makefile: "mk",
    make: "mk",
    mk: "mk",
    cmake: "cmake",
    dockerfile: "dockerfile",
    docker: "dockerfile",
    containerfile: "containerfile",
    vagrant: "vagrantfile",
    vagrantfile: "vagrantfile",
    jenkins: "jenkinsfile",
    jenkinsfile: "jenkinsfile",
    ansible: "yml",
    terraform: "tf",
    tf: "tf",
    hcl: "hcl",
    nix: "nix",
    dhall: "dhall",
    puppet: "pp",
    pp: "pp",
    chef: "rb",
    html: "html",
    htm: "html",
    xhtml: "xhtml",
    xml: "xml",
    xsl: "xsl",
    xslt: "xslt",
    svg: "svg",
    css: "css",
    scss: "scss",
    sass: "sass",
    less: "less",
    stylus: "styl",
    styl: "styl",
    postcss: "pcss",
    json: "json",
    json5: "json5",
    jsonc: "jsonc",
    ndjson: "ndjson",
    yaml: "yml",
    yml: "yml",
    toml: "toml",
    ini: "ini",
    conf: "conf",
    config: "conf",
    cnf: "conf",
    cfg: "cfg",
    properties: "properties",
    markdown: "md",
    md: "md",
    mdown: "md",
    mkdn: "md",
    mdx: "mdx",
    txt: "txt",
    text: "txt",
    plaintext: "txt",
    csv: "csv",
    tsv: "tsv",
    latex: "tex",
    tex: "tex",
    sty: "sty",
    cls: "cls",
    bibtex: "bib",
    bib: "bib",
    rst: "rst",
    asciidoc: "adoc",
    adoc: "adoc",
    asc: "adoc",
    org: "org",
    textile: "textile",
    graphql: "graphql",
    gql: "graphql",
    http: "http",
    rest: "http",
    proto: "proto",
    protobuf: "proto",
    thrift: "thrift",
    avro: "avsc",
    sql: "sql",
    mysql: "sql",
    pgsql: "sql",
    postgres: "sql",
    plsql: "plsql",
    tsql: "sql",
    hql: "hql",
    sparql: "sparql",
    rq: "sparql",
    cypher: "cyp",
    cyp: "cyp",
    mongo: "js",
    prisma: "prisma",
    solidity: "sol",
    sol: "sol",
    vyper: "vy",
    vy: "vy",
    assembly: "asm",
    asm: "asm",
    nasm: "asm",
    masm: "asm",
    gas: "s",
    s: "s",
    wasm: "wasm",
    wat: "wat",
    verilog: "v",
    sv: "sv",
    svh: "svh",
    vhdl: "vhd",
    vhd: "vhd",
    vh: "vh",
    cuda: "cu",
    cu: "cu",
    cuh: "cuh",
    opencl: "cl",
    cl: "cl",
    glsl: "glsl",
    vert: "vert",
    frag: "frag",
    geom: "geom",
    comp: "comp",
    hlsl: "hlsl",
    cg: "cg",
    shader: "shader",
    wolfram: "wl",
    wl: "wl",
    mathematica: "nb",
    nb: "nb",
    maple: "mpl",
    maxima: "mac",
    diff: "diff",
    patch: "patch",
    log: "log",
    env: "env",
    gitignore: "gitignore",
    dockerignore: "dockerignore",
    editorconfig: "editorconfig",
    license: "license",
    readme: "md",
    changelog: "md",
    nginx: "conf",
    apache: "conf",
    htaccess: "htaccess",
    htpasswd: "htpasswd",
    reg: "reg",
    vcf: "vcf",
    ics: "ics",
    svgz: "svgz",
    rss: "rss",
    atom: "xml",
    plist: "plist",
    t: "t",
    feature: "feature",
    gherkin: "feature",
  };
  return extensionMap[language.toLowerCase()] || "txt";
};

const handleDownload = (language: string, children: string) => {
  const extension = getFileExtension(language);
  const blob = new Blob([children], { type: "text/plain" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `code.${extension}`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
};

export { getFileExtension, handleDownload };
